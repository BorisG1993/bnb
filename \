export class PageLoader {
    
    #defLang = "he";
    contenPathPrefix;
    mediaPath;

    constructor() {
        if (!this.getLanguage()) this.setLanguage(defLang);
    }
    
    loadContent(path, renderContent) {
        fetch(path)
            .then(res => res.json())
            .then(data => renderContent(data))
            .catch(err => console.error("Error loading JSON:", err));
    }

    readText(path, setText) {
        fetch(path)
            .then(res => res.text())
            .then(text => setText(text))
            .catch(err => console.error("Error loading text file:", err));
    }

    getLanguage() {
        return localStorage.getItem("lang");
    }

    setLanguage(lang) {
        localStorage.setItem("lang", lang);
    }

    getContentPath() {
        return `${this.contentPathPrefix}${this.getLanguage()}.json`;
    }
}

export function readText(path) {
    return fetch(path)
        .then(res => res.text())
        .catch(err => console.error("Error loading text file:", err));
}

export function makeFrame(className, jsonObj) {
    
    const frame = document.createElement("div");
    frame.classList.add("general-frame", jsonObj.class, jsonObj.direction);
    
    if (jsonObj.images) {
        const imagesDiv = document.createElement("div");
        imagesDiv.className = "frame-images";

        jsonObj.images.forEach(src => {
            const img = document.createElement("img");
            img.src = src;
            imagesDiv.appendChild(img);
        });

        frame.appendChild(imagesDiv);
    }

    if (jsonObj.text) {
        const textDiv = document.createElement("div");
        textDiv.className = "frame-text";
        textDiv.innerText = jsonObj.text;
        frame.appendChild(textDiv);
    }

    if (jsonObj.links) {
        const linksDiv = document.createElement("div");
        linksDiv.className = "frame-links";

        jsonObj.links.forEach(src => {
            *** code here ***
            linksDiv.appendChild(link);
        });
        
        frame.appendChild(linksDiv);
    }

    return frame;
}


